generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id          Int       @id @default(autoincrement())
  nome        String
  email       String    @unique
  senhaHash   String
  dataCriacao DateTime  @default(now())
  respostas   RespostaUsuario[]
  resultados  ResultadoUsuario[]
}

model Formulario {
  id          Int        @id @default(autoincrement())
  titulo      String     @unique
  descricao   String?
  dataCriacao DateTime   @default(now())
  perguntas   Pergunta[]
}

model Pergunta {
  id           Int       @id @default(autoincrement())
  texto        String
  idFormulario Int
  formulario   Formulario @relation(fields: [idFormulario], references: [id])
  opcoes       Opcao[]
  respostas    RespostaUsuario[]
}

model Opcao {
  id          Int       @id @default(autoincrement())
  texto       String
  pontuacao   Int
  idPergunta  Int
  pergunta    Pergunta  @relation(fields: [idPergunta], references: [id])
  respostas   RespostaUsuario[]
}

model RespostaUsuario {
  id           Int       @id @default(autoincrement())
  idUsuario    Int
  usuario      Usuario   @relation(fields: [idUsuario], references: [id])
  idPergunta   Int
  pergunta     Pergunta  @relation(fields: [idPergunta], references: [id])
  idOpcao      Int
  opcao        Opcao     @relation(fields: [idOpcao], references: [id])
  dataResposta DateTime  @default(now())
}

model PerfilInvestidor {
  id          Int       @id @default(autoincrement())
  nomePerfil  String    @unique
  descricao   String
  resultados  ResultadoUsuario[]
}


model ResultadoUsuario {
  id               Int             @id @default(autoincrement())
  idUsuario        Int             @unique  
  usuario          Usuario         @relation(fields: [idUsuario], references: [id])
  idPerfil         Int
  perfil           PerfilInvestidor @relation(fields: [idPerfil], references: [id])
  pontuacaoTotal   Int
  dataClassificacao DateTime       @default(now())
}


